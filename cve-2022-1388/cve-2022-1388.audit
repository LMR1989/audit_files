#
# This script is Copyright (C) 2004-2022 and is owned by Tenable, Inc. or an Affiliate thereof.
#
# This .audit addresses a temporary stop gap in targets where the patch is not installed or feasible to install in a timely manner.
#
# Sources for additional information:
#   https://support.f5.com/csp/article/K23605346
#   https://cve.mitre.org/cgi-bin/cvename.cgi?name=2022-1388
#
#<ui_metadata>
#<display_name>F5 - Undisclosed requests may bypass iControl REST authentication</display_name>
#<spec>
#  <type>TNS</type>
#  <name>F5 - Undisclosed requests may bypass iControl REST authentication</name>
#  <version>1.0.0</version>
#  <link>https://support.f5.com/csp/article/K23605346</link>
#</spec>
#<labels>f5,cve,cve-2022-1388</labels>
#</ui_metadata>

<check_type : "F5">

<custom_item>
  description    : "CVE-2022-1388 - F5 - Undisclosed requests may bypass iControl REST authentication"
  info           : "Impact
This vulnerability may allow an unauthenticated attacker with network access to the BIG-IP system through the management port and/or self IP addresses to execute arbitrary system commands, create or delete files, or disable services. There is no data plane exposure; this is a control plane issue only.

Security Advisory Status
F5 Product Development has assigned IDs 1033837, 1051561, and 1052837 (BIG-IP) to this vulnerability. This issue has been classified as CWE-306: Missing Authentication for Critical Function.

To determine if your product and version have been evaluated for this vulnerability, refer to the Applies to (see versions) box. To determine if your release is known to be vulnerable, the components or features that are affected by the vulnerability, and for information about releases, point releases, or hotfixes that address the vulnerability, refer to the following table. For more information about security advisory versioning, refer to K51812227: Understanding security advisory versioning."
  solution       : "Please see https://support.f5.com/csp/article/K23605346 for mitigation steps."
  f5_command     : "/tm/sys/httpd"
  json_transform : ".include"
  expect         : "RequestHeader set connection close"
</custom_item>
    
</check_type>
