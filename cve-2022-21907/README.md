# CVE-2022-21907
According to the latest announcement issued by the Microsoft Security Response Center, Microsoft has issued a patch for a high-severity vulnerability found in Windows Server 2019 and Windows 10 in the latest cumulative update. The vulnerability ID is CVE-2022-21907, and the vulnerability can be exploited by sending specially crafted packets to exploit the HTTP protocol stack to launch an attack. Enterprise Administrators can also use the registry to disable certain inactive features to improve security if the lates cumulative update cannot be installed in a timely manner to fix the vulnerability. This mitigation applies to Windows Server version 2019 and Windows 10 (1809) and specifically disables the Trailer interface via the registry, which is used for HTTP header functionality.

Tenable audits can be used to check for the existence of this flaw.

## Audit information

Let's break down the audit and its output.

1. The Windows compliance plugin executes a REG_CHECK which evaluates for the existence of the specified platforms and searches for the vulnerable registry keys and reports a PASSED result if the mitigations exists or FAILED result if the mitigations do not exist.

The following registry paths are checked "HKLM\System\Currentcontrolset\Services\Http\Parameters" and key item "EnableTrailerSupport".

```
        <custom_item>
          type        : REG_CHECK
          description : "CVE-2022-21907 - HTTP Protocol Stack Remote Code Execution Vulnerability"
          info        : "According to the latest announcement issued by the Microsoft Security Response Center, Microsoft has issued a patch for a high-severity vulnerability found in Windows Server 2019 and Windows 10 in the latest cumulative update. The vulnerability ID is CVE-2022-21907, and the vulnerability can be exploited by sending specially crafted packets to exploit the HTTP protocol stack to launch an attack. Enterprise Administrators can also use the registry to disable certain inactive features to improve security if the lates cumulative update cannot be installed in a timely manner to fix the vulnerability. This mitigation applies to Windows Server version 2019 and Windows 10 (1809) and specifically disables the Trailer interface via the registry, which is used for HTTP header functionality."
          reference   : "CVE|CVE-2022-21907"
          see_also    : "https://msrc.microsoft.com/update-guide/vulnerability/CVE-2022-21907"
          value_type  : POLICY_TEXT
          value_data  : "HKLM\System\Currentcontrolset\Services\Http\Parameters"
          reg_option  : MUST_NOT_EXIST
          key_item    : "EnableTrailerSupport"
        </custom_item>
```

The audit will produce the following results when scanned against a passing target:
![PassingScan](images/cve-2022-21907-pass.png)

The audit will produce the following results when scanned against a failing target:
![FailingScan](images/cve-2022-21907-fail.png)

